<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ブースト！公式サイト（ドラフト）</title>
  <meta name="description" content="ブースト！イベント公式サイト（ドラフト）。開催概要・一般参加・サークル参加・サークル一覧・アクセス・Q&A・お問い合わせ。" />
  <!--
    フル版単一HTML（GitHub Pages向け）。
    - 外部依存なし（バニラJS/CSSのみ）
    - 固定ナビ / アンカー導線 / 50音フィルタ + 検索
    - サークル一覧は CSV 読み込み（content/circle-list.csv）失敗時は埋め込みダミーデータにフォールバック
    - 「区分」は非表示、SNSリンク複数対応
    - 初期状態ではサークル一覧は“行未選択”のため非表示 → 長いスクロールを回避
  -->
  <style>
    /* ===== リセットに近い最小限 ===== */
    *, *::before, *::after { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body { margin: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif; line-height: 1.6; color: #111; background: #fff; }
    img { max-width: 100%; height: auto; vertical-align: middle; }
    a { color: #0a58ca; text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* ===== カラーパレット（5色以内） ===== */
    :root {
      --accent: #0057D9;   /* 強調色 */
      --border: #E5E7EB;   /* 枠線 */
      --warn:   #B45309;   /* 警告 */
      --bg:     #F8FAFC;   /* 背景 */
      --text:   #111111;   /* 本文 */
    }

    /* ===== 固定ナビ ===== */
    .site-header { position: sticky; top: 0; z-index: 50; background: #fff; border-bottom: 1px solid var(--border); }
    .nav-wrap { display: flex; gap: .75rem; overflow-x: auto; padding: .75rem 1rem; -webkit-overflow-scrolling: touch; scrollbar-width: thin; }
    .brand { font-weight: 700; margin-right: .5rem; white-space: nowrap; }
    .nav { display: flex; gap: .5rem; }
    .nav a { white-space: nowrap; padding: .25rem .5rem; border-radius: .5rem; border: 1px solid transparent; }
    .nav a:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
    .nav a:hover { background: var(--bg); }

    /* ===== セクション ===== */
    section { padding: 2rem 1rem; border-bottom: 1px solid var(--border); scroll-margin-top: 4.25rem; }
    .container { max-width: 1100px; margin: 0 auto; }
    h1, h2 { line-height: 1.25; }
    h1 { font-size: clamp(1.5rem, 1.2rem + 1.5vw, 2.25rem); margin: 0 0 .75rem; }
    h2 { font-size: clamp(1.25rem, 1.1rem + 1vw, 1.75rem); margin: 0 0 1rem; }
    .lead { color: #333; }

    /* ===== ヒーロー ===== */
    .hero { background: linear-gradient(180deg, #ffffff 0%, #f6f9ff 100%); }
    .hero-grid { display: grid; grid-template-columns: 1.2fr .8fr; gap: 1rem; align-items: center; }
    @media (max-width: 860px){ .hero-grid { grid-template-columns: 1fr; } }
    .hero-card { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,.04); }
    .hero-meta { display: grid; grid-template-columns: max-content 1fr; gap: .25rem .75rem; margin: .75rem 0; }
    .cta { display: flex; flex-wrap: wrap; gap: .5rem; margin-top: .75rem; }
    .btn { display: inline-block; padding: .5rem .9rem; border-radius: 999px; border: 1px solid var(--accent); color: #fff; background: var(--accent); font-weight: 600; }
    .btn.secondary { color: var(--accent); background: #fff; }

    /* ===== カード＆テーブル ===== */
    .cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: .75rem; }
    .card { border: 1px solid var(--border); border-radius: 12px; background: #fff; padding: .75rem; }
    .muted { color: #555; font-size: .95rem; }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { border: 1px solid var(--border); padding: .5rem .6rem; text-align: left; }

    /* ===== サークル一覧 ===== */
    .finder { display: grid; gap: .75rem; background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: .75rem; }
    .finder .row { display: grid; gap: .5rem; }
    @media (min-width: 720px){ .finder .row { grid-template-columns: 1fr max-content; align-items: center; } }
    .kana { display: flex; flex-wrap: wrap; gap: .35rem; }
    .kana button { border: 1px solid var(--border); background: #fff; padding: .35rem .45rem; border-radius: .5rem; cursor: pointer; }
    .kana button[aria-pressed="true"] { background: var(--accent); color: #fff; border-color: var(--accent); }
    .searchbox { width: 100%; padding: .55rem .7rem; border: 1px solid var(--border); border-radius: .5rem; }
    .hint { font-size: .9rem; color: #444; }
    .circle-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: .75rem; margin-top: .75rem; }
    .circle-card { border: 1px solid var(--border); border-radius: 12px; overflow: hidden; background: #fff; display: grid; grid-template-rows: 140px auto; }
    .circle-thumb { background: #f3f4f6; display: grid; place-items: center; }
    .circle-body { padding: .6rem .7rem .8rem; display: grid; gap: .35rem; }
    .circle-name { font-weight: 700; }
    .circle-meta { font-size: .9rem; color: #333; }
    .sns { display: flex; flex-wrap: wrap; gap: .4rem; margin-top: .2rem; }
    .chip { border: 1px solid var(--border); border-radius: 999px; padding: .15rem .5rem; font-size: .85rem; background: #fff; }
    .empty { padding: .75rem; border: 1px dashed var(--border); border-radius: 12px; background: #fafafa; text-align: center; color: #666; }
    .note { font-size: .9rem; color: #444; }

    /* ===== フッター ===== */
    footer { padding: 2rem 1rem; color: #333; background: var(--bg); }
    .small { font-size: .9rem; color: #444; }
  </style>
</head>
<body>
  <!-- ========== 固定ナビ ========== -->
  <header class="site-header" role="banner">
    <div class="nav-wrap container">
      <div class="brand">🚀 ブースト！</div>
      <nav class="nav" aria-label="主要ナビゲーション">
        <!-- アンカーはセクションIDと一致させること -->
        <a href="#hero">トップ</a>
        <a href="#news">最新情報</a>
        <a href="#schedule">当日スケジュール</a>
        <a href="#visitor">一般参加</a>
        <a href="#circle">サークル参加</a>
        <a href="#catalog">サークル一覧</a>
        <a href="#venue">会場内案内</a>
        <a href="#access">アクセス</a>
        <a href="#qa">Q&A</a>
        <a href="#contact">お問い合わせ</a>
      </nav>
    </div>
  </header>

  <!-- ========== ヒーロー ========== -->
  <section id="hero" class="hero" aria-labelledby="hero-title">
    <div class="container hero-grid">
      <div class="hero-card">
        <h1 id="hero-title">ブースト！— 同人&創作イベント</h1>
        <p class="lead">初めての方でも迷わない導線。開催日・会場・入場方法を最短でご案内します。</p>
        <div class="hero-meta" aria-label="開催概要">
          <div>開催日</div><div><strong>2025/10/12（日）</strong> 10:00–16:00</div>
          <div>会　場</div><div><strong>ブーストホール</strong>（〇〇市△△区ホールA）</div>
          <div>入　場</div><div>パンフ購入制 <strong>1冊 1,000円</strong>（再入場可）</div>
        </div>
        <div class="cta" role="group" aria-label="主要導線">
          <a class="btn" href="#visitor">一般参加ガイド</a>
          <a class="btn secondary" href="#circle">サークル参加ガイド</a>
        </div>
        <p class="muted small">※ 記載はドラフトです。内容は予告なく変更になる場合があります。</p>
      </div>
      <div aria-hidden="true" class="hero-card">
        <img src="assets/hero.jpg" alt="会場イメージ（サンプル画像）" />
      </div>
    </div>
  </section>

  <!-- ========== 最新情報 ========== -->
  <section id="news" aria-labelledby="news-title">
    <div class="container">
      <h2 id="news-title">最新情報（最大5件）</h2>
      <div class="cards" id="news-list" role="list">
        <!-- JSで挿入。YYYY/MM/DD + 40文字以内見出し。 -->
      </div>
      <p class="small muted">古いお知らせはアーカイブに移動します。</p>
    </div>
  </section>

  <!-- ========== 当日スケジュール ========== -->
  <section id="schedule" aria-labelledby="schedule-title">
    <div class="container">
      <h2 id="schedule-title">当日スケジュール</h2>
      <div class="card">
        <table class="table" aria-describedby="schedule-note">
          <thead>
            <tr><th scope="col">時刻</th><th scope="col">内容</th></tr>
          </thead>
          <tbody id="schedule-body">
            <!-- JSで6〜8行挿入 -->
          </tbody>
        </table>
        <p id="schedule-note" class="note">※ 時刻・内容は予告なく変更になる場合があります。</p>
      </div>
    </div>
  </section>

  <!-- ========== 一般参加 ========== -->
  <section id="visitor" aria-labelledby="visitor-title">
    <div class="container">
      <h2 id="visitor-title">一般参加ガイド</h2>
      <div class="cards">
        <div class="card">
          <h3>年齢確認</h3>
          <ul>
            <li>18歳未満の方はR-18エリアに入場できません。</li>
            <li>顔写真付き身分証の提示をお願いする場合があります。</li>
          </ul>
        </div>
        <div class="card">
          <h3>入場・再入場</h3>
          <ul>
            <li>入場はパンフ購入制（<strong>1冊 1,000円</strong>）。</li>
            <li>リストバンドご着用で再入場が可能です。</li>
          </ul>
        </div>
        <div class="card">
          <h3>抽選</h3>
          <ul>
            <li>抽選券は<strong>10:00</strong>配布開始、抽選は<strong>12:00</strong>実施予定。</li>
          </ul>
        </div>
        <div class="card">
          <h3>持ち物・注意</h3>
          <ul>
            <li>小銭／エコバッグ／水分補給用ドリンク。</li>
            <li>転売目的の購入は禁止です。</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- ========== サークル参加 ========== -->
  <section id="circle" aria-labelledby="circle-title">
    <div class="container">
      <h2 id="circle-title">サークル参加ガイド</h2>
      <div class="cards">
        <div class="card">
          <h3>参加資格</h3>
          <p class="muted">オリジナル／二次創作の頒布が可能な個人・団体。</p>
        </div>
        <div class="card">
          <h3>ブース・料金</h3>
          <ul>
            <li>1ブース：<strong>5,000円</strong>（机1・椅子2・入場証2名）</li>
            <li>追加椅子：<strong>1脚 500円</strong></li>
          </ul>
        </div>
        <div class="card">
          <h3>当日フロー</h3>
          <ol>
            <li>搬入：<strong>8:30</strong>〜</li>
            <li>見本誌提出・表記確認</li>
            <li>撤収：<strong>16:00</strong>〜</li>
          </ol>
        </div>
        <div class="card">
          <h3>見本誌・表記</h3>
          <p class="muted">年齢区分・表紙表記・注意書きの明記にご協力ください。</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ========== サークル一覧（検索 + 50音） ========== -->
  <section id="catalog" aria-labelledby="catalog-title">
    <div class="container">
      <h2 id="catalog-title">サークル一覧</h2>
      <div class="finder" role="region" aria-label="サークル検索">
        <div class="row">
          <label for="query" class="hint">キーワード検索（サークル名 / PN / スペース番号 / SNS）</label>
          <input id="query" class="searchbox" type="search" placeholder="例）ねこ / A-12 / @sample" inputmode="search" />
        </div>
        <div class="row">
          <div class="hint">50音で絞り込み（<strong>未選択時は一覧を表示しません</strong>）</div>
          <div class="kana" role="toolbar" aria-label="50音選択" id="kana-toolbar">
            <!-- JSでボタン挿入：あ か さ た な は ま や ら わ -->
          </div>
        </div>
        <div class="row">
          <div class="hint">表示件数：<span id="count">0</span>件</div>
          <div class="hint"><button id="resetBtn" class="kana" style="padding:.35rem .6rem">条件クリア</button></div>
        </div>
        <div id="catalog-empty" class="empty" role="status">50音を選ぶか、検索してください。</div>
        <div id="circle-grid" class="circle-grid" hidden></div>
      </div>
      <p class="small muted">サムネイルは1枚まで。SNSは複数登録可（X/Instagram/Booth/自サイトなど）。</p>
    </div>
  </section>

  <!-- ========== 会場内案内（配置図の文章要約） ========== -->
  <section id="venue" aria-labelledby="venue-title">
    <div class="container">
      <h2 id="venue-title">会場内案内（要約）</h2>
      <ul>
        <li>受付：ホールA入口左手。年齢確認後、リストバンド配布。</li>
        <li>抽選会場：ロビー奥・掲示板前。</li>
        <li>島配置：一方通行（時計回り）。</li>
        <li>非常口：2ヶ所（ホール左右）。</li>
        <li>喫煙所：屋外テラス。</li>
        <li>再入場：リストバンド提示で可。</li>
      </ul>
    </div>
  </section>

  <!-- ========== アクセス ========== -->
  <section id="access" aria-labelledby="access-title">
    <div class="container">
      <h2 id="access-title">アクセス</h2>
      <div class="cards">
        <div class="card">
          <h3>電車</h3>
          <ul>
            <li>〇〇駅（東口）から<strong>徒歩5分</strong></li>
            <li>△△駅（北口）から<strong>徒歩12分</strong></li>
          </ul>
        </div>
        <div class="card">
          <h3>注意</h3>
          <ul>
            <li>駐車台数に限りがあります。公共交通機関をご利用ください。</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- ========== Q&A ========== -->
  <section id="qa" aria-labelledby="qa-title">
    <div class="container">
      <h2 id="qa-title">Q&A（3〜5件）</h2>
      <details class="card"><summary><strong>入場は何時から並べますか？</strong></summary><div class="muted">スタッフ案内に従い、<strong>9:30</strong>以降に整列をお願いします。</div></details>
      <details class="card"><summary><strong>飲食は可能ですか？</strong></summary><div class="muted">所定の休憩スペースでのみ可能です。会場内での飲食はご遠慮ください。</div></details>
      <details class="card"><summary><strong>荷物は預けられますか？</strong></summary><div class="muted">コインロッカー（有料）をご利用ください。</div></details>
    </div>
  </section>

  <!-- ========== お問い合わせ ========== -->
  <section id="contact" aria-labelledby="contact-title">
    <div class="container">
      <h2 id="contact-title">お問い合わせ</h2>
      <p class="muted">バグ報告／改善要望のみ。個別返信は行いません。匿名・画像のみ（個人情報の記載は不可）。</p>
      <p><a class="btn" href="#" id="issueLink" target="_blank" rel="noopener">GitHub Issue フォームを開く</a></p>
      <p class="small">送信ありがとうございました。必要に応じて更新履歴に反映します。</p>
    </div>
  </section>

  <footer role="contentinfo">
    <div class="container small">&copy; 2025 ブースト実行委員会 / Draft on GitHub Pages</div>
  </footer>

  <script>
    // ================================
    // ユーティリティ関数
    // ================================
    /** 先頭のかなを行（あ/か/さ…）に正規化する。カタカナも許容。 */
    function kanaInitial(str) {
      if (!str) return null;
      const kana = (str + "").trim().charAt(0)
        .replace(/[Ａ-Ｚａ-ｚ０-９]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0)) // 全角→半角
        .replace(/[ァ-ン]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60)); // カタカナ→ひらがな
      const ch = kana.charCodeAt(0);
      const ranges = [
        { k: "あ", start: 0x3042, list: "あいうえお" },
        { k: "か", start: 0x304B, list: "かきくけこがぎぐげご" },
        { k: "さ", start: 0x3055, list: "さしすせそざじずぜぞ" },
        { k: "た", start: 0x305F, list: "たちつてとだぢづでど" },
        { k: "な", start: 0x306A, list: "なにぬねの" },
        { k: "は", start: 0x306F, list: "はひふへほばびぶべぼぱぴぷぺぽ" },
        { k: "ま", start: 0x307E, list: "まみむめも" },
        { k: "や", start: 0x3084, list: "やゆよ" },
        { k: "ら", start: 0x3089, list: "らりるれろ" },
        { k: "わ", start: 0x308F, list: "わをん" },
      ];
      for (const r of ranges) if (r.list.includes(String.fromCharCode(ch))) return r.k;
      return "その他"; // 英数字や記号など
    }

    /** テキスト正規化（検索用・大文字小文字/全半角/カナ差異の吸収） */
    function norm(txt){
      if (!txt) return "";
      const half = (txt+"")
        .replace(/[Ａ-Ｚａ-ｚ０-９]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0))
        .toLowerCase();
      // カタカナ→ひらがな
      return half.replace(/[ァ-ン]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60));
    }

    /** 要素生成の小ヘルパー */
    function el(tag, props={}, children=[]) {
      const node = document.createElement(tag);
      Object.assign(node, props);
      for (const child of children) node.append(child);
      return node;
    }

    // ================================
    // ダミーデータ（CSV失敗時のフォールバック）
    // ================================
    const FALLBACK_CIRCLES = [
      { name: "ねこファクトリ", pn: "猫山", space: "A-01", kana: "ね", sns: ["https://x.com/neko", "https://instagram.com/neko"], thumb: "assets/sample1.jpg" },
      { name: "からす堂", pn: "鳥井", space: "A-12", kana: "か", sns: ["https://x.com/karasu"], thumb: "assets/sample2.jpg" },
      { name: "まんがラボ", pn: "田中", space: "B-07", kana: "ま", sns: ["https://booth.pm/xyz"], thumb: "assets/sample3.jpg" },
      { name: "ワークスβ", pn: "beta", space: "C-15", kana: "わ", sns: ["https://example.com"], thumb: "assets/sample4.jpg" },
      { name: "Others_01", pn: "Dev", space: "D-02", kana: "その他", sns: ["https://x.com/dev"], thumb: "assets/sample2.jpg" },
    ];

    const NEWS = [
      { date: "2025/08/10", title: "ドラフト公開を開始しました（最大5件表示）。" },
      { date: "2025/08/09", title: "サークルリストのCSV取り込みに対応しました。" },
      { date: "2025/08/05", title: "サイト仕様 v0.1（ドラフト）を公開。" },
    ];

    const SCHEDULE = [
      ["08:30", "サークル搬入開始"],
      ["09:30", "一般整列開始"],
      ["10:00", "開場（パンフ販売開始）"],
      ["12:00", "抽選会（ロビー）"],
      ["15:30", "頒布終了アナウンス"],
      ["16:00", "閉場・撤収開始"],
    ];

    // ================================
    // 初期描画（ニュース・スケジュール）
    // ================================
    function initNews(){
      const wrap = document.getElementById('news-list');
      NEWS.slice(0,5).forEach(item => {
        const card = el('article', { className: 'card', role: 'listitem' }, [
          el('div', { className: 'muted small', textContent: item.date }),
          el('div', { textContent: item.title })
        ]);
        wrap.append(card);
      });
    }

    function initSchedule(){
      const tbody = document.getElementById('schedule-body');
      SCHEDULE.slice(0,8).forEach(([t, c]) => {
        const tr = el('tr', {}, [
          el('td', { textContent: t }),
          el('td', { textContent: c })
        ]);
        tbody.append(tr);
      });
    }

    // ================================
    // サークルCSV読込（content/circle-list.csv）
    //   期待カラム：name,pn,space,thumb(optional),sns(optional;空白区切り)
    //   例：ねこファクトリ,猫山,A-01,assets/sample1.jpg,https://x.com/neko https://instagram.com/neko
    // ================================
    async function loadCircles(){
      try {
        const res = await fetch('content/circle-list.csv', { cache: 'no-store' });
        if (!res.ok) throw new Error('CSV not found');
        const csv = await res.text();
        const lines = csv.split(/\r?\n/).filter(Boolean);
        const header = lines.shift();
        const cols = header.split(',').map(s => s.trim());
        const idx = {
          name: cols.indexOf('name'), pn: cols.indexOf('pn'), space: cols.indexOf('space'),
          thumb: cols.indexOf('thumb'), sns: cols.indexOf('sns')
        };
        const rows = lines.map(line => {
          // カンマを単純分割（ダブルクォート込みCSVに未対応：GitHub Pagesの想定簡易仕様）
          const a = line.split(',');
          const name = (a[idx.name]||'').trim();
          const pn   = (a[idx.pn]||'').trim();
          const space= (a[idx.space]||'').trim();
          const thumb= (a[idx.thumb]||'').trim();
          const sns  = (a[idx.sns]||'').trim();
          return {
            name, pn, space,
            kana: kanaInitial(name),
            thumb: thumb || '',
            sns: sns ? sns.split(/\s+/) : []
          };
        });
        if (!rows.length) throw new Error('empty');
        return rows;
      } catch (e){
        console.warn('[catalog] CSV読込に失敗したためフォールバックを使用:', e.message);
        return FALLBACK_CIRCLES.map(c => ({...c, kana: c.kana || kanaInitial(c.name)}));
      }
    }

    // ================================
    // サークル一覧UI
    //   - 初期状態：非表示（50音or検索で表示）
    //   - 長いスクロールを回避
    // ================================
    const KANA_KEYS = ["あ","か","さ","た","な","は","ま","や","ら","わ","その他"];

    function buildKanaToolbar(){
      const bar = document.getElementById('kana-toolbar');
      KANA_KEYS.forEach(k => {
        const b = el('button', { type: 'button', textContent: k, 'aria-pressed': 'false' });
        b.addEventListener('click', () => selectKana(k, b));
        bar.append(b);
      });
    }

    let ALL_CIRCLES = [];
    let state = { kana: null, q: '' };

    function selectKana(k, btn){
      state.kana = (state.kana === k) ? null : k; // 同じボタンでトグル解除
      // ボタンの aria-pressed 更新
      document.querySelectorAll('#kana-toolbar button').forEach(b => b.setAttribute('aria-pressed', String(b === btn && state.kana)));
      renderCircles();
    }

    function matches(c, st){
      const okKana = !st.kana || c.kana === st.kana;
      const nq = norm(st.q);
      const blob = norm([c.name, c.pn, c.space, ...(c.sns||[])].join(' '));
      const okQ = !nq || blob.includes(nq);
      return okKana && okQ;
    }

    function circleCard(c){
      const wrap = el('article', { className: 'circle-card' });
      const img = c.thumb ? el('img', { src: c.thumb, alt: `${c.name} のサムネイル` }) : el('div', { className: 'circle-thumb', textContent: 'No Image' });
      wrap.append(el('div', { className: 'circle-thumb' }, [img]));
      const body = el('div', { className: 'circle-body' });
      body.append(el('div', { className: 'circle-name', textContent: c.name }));
      body.append(el('div', { className: 'circle-meta', textContent: `PN：${c.pn}　/　スペース：${c.space}` }));
      // 区分は不要指定のため表示しない
      const snsWrap = el('div', { className: 'sns' });
      (c.sns||[]).forEach(u => snsWrap.append(el('a', { href: u, target: '_blank', rel: 'noopener', className: 'chip', textContent: new URL(u).hostname.replace(/^www\./,'') })));
      body.append(snsWrap);
      wrap.append(body);
      return wrap;
    }

    function renderCircles(){
      const grid = document.getElementById('circle-grid');
      const empty = document.getElementById('catalog-empty');
      const list = ALL_CIRCLES.filter(c => matches(c, state));
      document.getElementById('count').textContent = list.length;
      grid.innerHTML = '';
      if (!state.kana && !state.q){
        grid.hidden = true; empty.hidden = false; return;
      }
      empty.hidden = true; grid.hidden = false;

      // 必要最小限のみ描画（先頭から最大 60 件などで軽量化）
      const MAX = 60;
      const slice = list.slice(0, MAX);
      for (const c of slice) grid.append(circleCard(c));
      if (list.length > MAX){
        grid.append(el('div', { className: 'empty', textContent: `ほか ${list.length - MAX}件。条件を追加して絞り込んでください。` }));
      }
    }

    function bindFinder(){
      const q = document.getElementById('query');
      q.addEventListener('input', () => { state.q = q.value; renderCircles(); });
      document.getElementById('resetBtn').addEventListener('click', () => {
        state = { kana: null, q: '' };
        q.value = '';
        document.querySelectorAll('#kana-toolbar button').forEach(b => b.setAttribute('aria-pressed', 'false'));
        renderCircles();
      });
    }

    // ================================
    // お問い合わせリンク（本番ではWPのカスタムフィールド等で差し替え）
    // ================================
    function initIssueLink(){
      const ISSUE_URL = 'https://github.com/your/repo/issues/new/choose'; // TODO: 本番用URLに置換
      const a = document.getElementById('issueLink');
      a.href = ISSUE_URL;
    }

    // ================================
    // 起動
    // ================================
    (async function main(){
      initNews();
      initSchedule();
      buildKanaToolbar();
      bindFinder();
      initIssueLink();
      ALL_CIRCLES = await loadCircles();
      renderCircles(); // 初回は非表示のまま（empty案内のみ）
    })();
  </script>
</body>
</html>
